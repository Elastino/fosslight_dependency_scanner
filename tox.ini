# Copyright (c) 2021 LG Electronics
# SPDX-License-Identifier: Apache-2.0
[tox]
envlist = test_run
skipdist = true

[testenv]
install_command = pip install {opts} {packages}
basepython= python3.6
setenv =
  PYTHONPATH=.

[pytest]
filterwarnings = ignore::DeprecationWarning

[flake8]
max-line-length = 130
exclude = .tox/*
ignore = E722

[testenv:test_run]
commands =
  fosslight_dependency -h

[testenv:release]
deps =
  -r{toxinidir}/requirements-dev.txt

commands =
  fosslight_dependency -h
  fosslight_dependency -v
  # Test for Pypi
  fosslight_dependency -p tests -o tests -m pip -a "source {toxinidir}/.tox/test_run/bin/activate" -d "deactivate"
  pytest -v --flake8
  pyinstaller --onefile cli.py build.spec --additional-hooks-dir=hooks
  {toxinidir}/dist/cli -o test_result_cli
  
